{% extends "layout.html" %}
{% load humanize %}
{% block stylesheets %}
<link type="text/css" rel="stylesheet" href="{{ MEDIA_URL }}rapidsms/stylesheets/layout.css" />
<link type="text/css" rel="stylesheet" href="{{ MEDIA_URL }}rapidsms/stylesheets/splits.css" />
<link type="text/css" rel="stylesheet" href="{{ MEDIA_URL }}rapidsms/stylesheets/modules.css" />
<link type="text/css" rel="stylesheet" href="{{ MEDIA_URL }}rapidsms/stylesheets/icons.css" />
<link type="text/css" rel="stylesheet" href="{{ MEDIA_URL }}generic/stylesheets/generic.css" />
<link type="text/css" rel="stylesheet" href="{{MEDIA_URL}}education/stylesheets/emis.css"/>
<link type="text/css" rel="stylesheet" href="{{MEDIA_URL}}education/stylesheets/jquery-ui-1.7.3.custom.css"/>
{% endblock %}
{% block javascripts %}
{{ block.super }}
<!-- {% include "education/partials/chart/javascripts.html" %} -->
<script type="text/javascript" src="{{ MEDIA_URL }}education/javascripts/highcharts.js"></script>
<script type="text/javascript" src="{{ MEDIA_URL }}education/javascripts/emis_dashboard_charts.js"></script>
<script type="text/javascript" src="{{ MEDIA_URL }}education/javascripts/jquery-ui-1.7.3.custom.min.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.min.js"></script>
{% endblock javascripts %}
{% block content %}
<table width="100%" cellpadding="5" cellspacing="0">
    <tr>
        <td id="map" width="350" height="400" valign="top" style="width:350px;"></td>
        <td id="attdance" width="100%" height="400" valign="top"></td>
    </tr>

    <tr>
        <td colspan="2" id="progress"></td>
    </tr>
    <tr>
        <td colspan="2">
            <table width="100%" cellpadding="5" cellspacing="0">
                <tr>
                    <td id="violence_holder" width="50%" height="200" valign="top" style="border-right:1px solid #efefef;border-bottom:1px solid #efefef;">
                        <div class="violence">
<!--                            <h1 class="title">Violence Cases Recorded</h1> -->
                            <div>
                                <span class="label important">Districts with the Highest Cases of Violence Recorded this Month</span>
                                <div style="padding: 10px;">
                                    <table class="classy">
                                        <thead>
                                        <tr>
                                            <th>District</th>
                                            <th>Number</th>
                                        </tr>
                                        </thead>
                                        <!-- get context vars working -->
                                        {% if top_three_violent_districts %}
                                            {% for district, list in top_three_violent_districts %}
                                            <tr><td><a>{{ district }}</a></td><td>{{ list.0 }}</td></tr>
                                            {% endfor %}
                                        {% endif %}
                                    </table>
                                </div>
                                <div>
                                    <span class="alert-message">45% increase in violence this month</span>
                                    <span class="label notice"><a style="cursor:pointer; color:white;" href="{% url violence-admin-details %}">Other Cases >></a></span>
                                </div>
                            </div>                      
                        </div>
                    </td>
                    <td id="meals_holder" width="50%" height="200" valign="top" style="border-right:1px solid #efefef;border-bottom:1px solid #efefef;">
                        <div class="meal">
                            <div style="margin-bottom: 20px;">
                                <span class="label warning">Districts with the Highest Percentage of Pupils that didn't have Meals</span>
                                <div style="padding: 10px;">
                                    <table class="classy">
                                        <thead>
                                        <tr>
                                            <th>District</th>
                                            <th>Percentage</th>
                                        </tr>
                                        </thead>
                                        {% if top_three_hungry_districts %}
                                            {% for district, list in top_three_hungry_districts %}
                                                <tr><td><a>{{ district }}</a></td><td>{{ list.0 }}%</td></tr>
                                            {% endfor %}
                                        {% endif %}
                                    </table>
                                </div>


                            </div>
                            <div>
                                <!--TODO generate the alert-message based on poll responses -->
                                <span class='alert-message'>Report based on 45% of Total Reporters</span>
                                <span class="label notice"><a style="cursor:pointer; color:white; margin-top: 20px;" href="{% url admin-meals-details %}">Other Cases >></a></span>
                            </div>
                        </div>
                    </td>
                </tr>

                <tr>
                    <!-- TODO finish up meetings context vars and look -->
                    <td id="meetings_holder" width="50%" height="200" valign="top" style="border-right:1px solid #efefef;border-bottom:1px solid #efefef;">
                        <div class="meeting" style="margin-bottom: 10px;">
                            <h1 class="title">SMC Meetings Held This School Term</h1>
                            <table class="classy">
                                <thead>
                                <tr>
                                    <th>
                                        Number of Meetings
                                    </th>
                                    <th>
                                        Percentage
                                    </th>
                                </tr>
                                </thead>
                                <tr><td>1</td><td>78%</td></tr>
                                <tr><td>3</td><td>13%</td></tr>
                                <tr><td>2</td><td>9%</td></tr>
                            </table>
                        </div>
                        <div class="alert-message">
                            <p>Report based on 35% of Total Reporters</p>
                        </div>
                    </td>

                    <td id="capitation" width="50%" height="400" valign="top"></td>
                </tr>
            </table>
        </td>
    </tr>
</table>
<script type="text/javascript">
    $(document).ready(function(){
        $('#map').load('{% url emis-dash-map %}');
        $('#attdance').load('{% url emis-dash-attdance %}');
        $("#progress").load('{% url emis-admin-curriculum-progress %}');
        $('#capitation').load('{% url emis-ministry-dash-capitation %}');
    });
</script>
{% endblock %}