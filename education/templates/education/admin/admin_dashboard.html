{% extends "education/layout_base.html" %}
{% load humanize %}
{% load stats_extras %}
{% block title %}
Dashboard -- {{ block.super }}
{% endblock %}
{% block content %}

<div class="inner-content">
    <div class="content">
        <div class="section this-week">
            <h1 class="section-title calendar">This Week ({{ month|date:"D d M Y" }})</h1>
            <div class="attendance">
                <h2 class="block-header">Absenteeism</h2>
                <div class="top">
                    <table class="tabulated-data">
                    	<!--Searching for the bug in display -->
                        <tr><th>Group</th><th>Absent (%) This week</th><th>Absent (%) Last week</th><th>Weekly Change</th></tr>
                        <tr>
                            <td><a href="{% url detail-attendance-visualization %}">Boys P3</a></td>
                            <td>{% if boysp3 == '--' %} {{ boysp3 }} {% else %} {{ boysp3|floatformat }}% {% endif %}</td>
                            <td>
                                {% if boysp3_past == '--' %} {{ boysp3_past }} {% else %} {{ boysp3_past|floatformat }}% {% endif %}
                            </td>

                            <td class="{{ boysp3_data }}">
                                <span class="{{ boysp3_class  }}">
                                    {% if boysp3_diff == '--' %}
                                    {{ boysp3_diff }}
                                    {% else %}
                                    {{ boysp3_diff|floatformat }}%
                                    {% endif %}
                                </span>
                            </td>
                        </tr>
                        <tr>
                            <td><a href="{% url detail-attendance-visualization %}">Girls P3</a></td>
                            <td>{% if girlsp3 == '--' %} {{ girlsp3 }} {% else %}{{ girlsp3|floatformat }}%{% endif %}</td>
                            <td>{% if girlsp3_past == '--' %} {{ girlsp3_past }} {% else %}{{ girlsp3_past|floatformat }}%{% endif %}</td>
                            <td class="{{ girlsp3_data }}"><span class="{{ girlsp3_class }}">
                                {% if girlsp3_diff == '--' %}
                                {{ girlsp3_diff }}
                                {% else %}
                                {{ girlsp3_diff|floatformat }}%
                                {% endif %}
                            </span></td>
                        </tr>
                        <tr>
                            <td><a href="{% url detail-attendance-visualization %}">Boys P6</a></td>
                            <td>{% if boysp6 == '--' %} {{ boysp6 }} {% else %} {{ boysp6|floatformat }}%{% endif %}</td>
                            <td>{% if boysp6_past == '--' %} {{ boysp6_past }} {% else %}{{ boysp6_past|floatformat }}%{% endif %}</td>
                            <td class="{{ boysp6_data }}">
                                <span class="{{ boysp6_class }}">{% if boysp6_diff == '--' %} {{ boysp6_diff }} {% else %}
                                    {{ boysp6_diff|floatformat }}%{% endif %}</span>
                            </td>
                        </tr>
                        <tr>
                            <td><a href="{% url detail-attendance-visualization %}">Girls P6</a></td>
                            <td>{% if girlsp6 == '--' %}{{ girlsp6 }} {% else %}{{ girlsp6|floatformat }}%{% endif %}</td>
                            <td>{% if girlsp6_past == '--' %}{{ girlsp6_past }} {% else %}{{ girlsp6_past|floatformat }}%{% endif %}</td>
                            <td class="{{ girlsp6_data }}">
                                <span class="{{ girlsp6_class }}">
                                    {% if girlsp6_diff == '--' %}
                                        {{ girlsp6_diff }}
                                    {% else %}
                                        {{ girlsp6_diff|floatformat }}%
                                    {% endif %}
                                </span>
                            </td>
                        </tr>
                        <tr>
                            <td><a href="{% url detail-attendance-visualization %}">Female Teachers</a></td>
                            <td>{% if female_teachers == '--' %} {{ female_teachers }} {% else %} {{ female_teachers|floatformat }}%{% endif %}</td>
                            <td>{% if female_teachers_past == '--' %} {{ female_teachers_past }} {% else %}
                                {{ female_teachers_past|floatformat }}%{% endif %}</td>
                            <td class="{{ female_teachers_data }}">
                                <span class="{{ female_teachers_class }}">
                                    {% if female_teachers_diff == '--' %} {{ female_teachers_diff }} {% else %}{{ female_teachers_diff|floatformat }}%{% endif %}</span>
                            </td>
                        </tr>
                        <tr>
                            <td><a href="{% url detail-attendance-visualization %}">Male Teachers</a></td>
                            <td>{% if male_teachers == '--' %} {{ male_teachers }} {% else %} {{ male_teachers|floatformat }}%{% endif %}</td>
                            <td>{% if male_teachers_past == '--' %} {{ male_teachers_past }} {% else %} {{ male_teachers_past|floatformat }}%{% endif %}</td>
                            <td class="{{ male_teachers_data }}">
                                <span class="{{ male_teachers_class }}">{% if male_teachers_diff == '--' %} {{ male_teachers_diff }}
                                    {% else %} {{ male_teachers_diff|floatformat }}%{% endif %}</span>
                            </td>
                        </tr>
                        <tr>
                            <td><a href="{% url detail-attendance-visualization %}">Female H Teachers</a></td>
                            <td>{% if f_head_t_week == '--' %} {{ f_head_t_week }} {% else %} {{ f_head_t_week|floatformat }}%{% endif %}</td>
                            <td>{% if f_head_t_week_before == '--' %}{{ f_head_t_week_before }} {% else %} {{ f_head_t_week_before|floatformat }}%{% endif %}</td>
                            <td class="{{ f_head_t_data }}"><span class="{{ f_head_t_class }}">{% if f_head_diff == '--' %}{{ f_head_diff }}{% else %} {{ f_head_diff|floatformat }}%{% endif %}</span></td>
                        </tr>
                        <tr>
                            <td><a href="{% url detail-attendance-visualization %}">Male H Teachers</a></td>
                            <td>{% if m_head_t_week == '--' %} {{ m_head_t_week }} {% else %} {{ m_head_t_week|floatformat }}%{% endif %}</td>
                            <td>{% if m_head_t_week_before == '--' %}{{ m_head_t_week_before }} {% else %} {{ m_head_t_week_before|floatformat }}%{% endif %}</td>
                            <td class="{{ m_head_t_data }}">
                            	<span class="{{ m_head_t_class }}">
                            		{% if m_head_diff == '--' %}{{ m_head_diff }}{% else %} {{ m_head_diff|floatformat }}%{% endif %}
                                </span>
                            </td>
                        </tr>
                    </table>
                </div>
                <div class="actions">
                    <a class="button button-purple" href="{% url attendance-admin-details%}"><span class="details">View Details</span></a>
                    <a class="button button-purple" href="#"><span class="graph">View Graph</span></a>
                    <div class="clear"></div>
                </div>
            </div>

            <div class="curriculum-progress">
                <h2 class="block-header">Curriculum Progress</h2>
                <div class="top">
                    <h3>P3 Literacy</h3>
                    <p>Shows how far on schedule the current literacy of P3 students is.</p>
                    <div class="progress">
                        {% if c_mode|islist %}
                            <span style="width:{{ mode_progress }}%;"><b>{{ c_mode|format_mode }}</b></span>
                        {% else %}
                            <p style="color:red;">{{ c_mode }}</p>
                        {% endif %}

                    </div>
                </div>
                <div class="actions">
                    <a class="button button-purple" href="{% url emis-admin-curriculum-progress %}"><span class="details">View Details</span></a>
                    <div class="clear"></div>
                </div>
            </div>
            <div class="clear"></div>
        </div>

        <div class="section this-month">
            <h1 class="section-title month">This Month ({{ month|date:"M Y" }})</h1>
            <div class="container">
                <div class="top">

                    <div class="violence">
                        <h3>Violence Cases Girls</h3>
                        <div class="data {{ violence_change_girls_data }}"><span class="value {{ violence_change_girls_class }}">{{ violence_change_girls|floatformat }}%
                            <br />{{ violence_change_girls_class }}</span>
                        </div>
                    </div>
                    <div class="violence">
                        <h3>Violence Cases Boys</h3>
                        <div class="data {{ violence_change_boys_data }}"><span class="value {{ violence_change_boys_class }}">{{ violence_change_boys|floatformat }}%
                            <br />{{ violence_change_boys_class }}</span>
                        </div>
                    </div>
                    <div class="violence">
                        <h3>Violence Cases Referred</h3>
                        <div class="data {{ violence_change_reported_data }}"><span class="value {{ violence_change_reported_class }}">{{ violence_change_reported|floatformat }}%
                            <br />{{ violence_change_reported_class }}</span>
                        </div>
                    </div>

                    <div class="missed-meals">
                        <h3>Missed Meals at School</h3>
                        <div class="data {{ meal_change_data }}">
                            <span class="value {{ meal_change_class }}">
                                {{ worst_meal.1.0.1|floatformat }}%
                            </span>

                        </div>
                    </div>
                    <div class="clear"></div>
                    <div class="actions" style="float:left; margin-left: 190px;">
                        <a class="button button-purple" href="{% url violence-admin-details %}" style="float:right;"><span class="details">View Details</span></a>
                    </div>
                    <div class="actions">
                        <a class="button button-purple" href="{% url admin-meals-details %}"><span class="details">View Details</span></a>
                    </div>

                </div>
            </div>
        </div>
        <div class="section this-term">
            <h1 class="section-title term">This Term</h1>
            <div class="container">
                <div class="top">
                    <div class="div-1" style="float:left;">
                        <div class="data data-zero"><span class="value zero">{{ smc_meetings|floatformat }}%</span></div>
                        <p>of School Management Commitees held a meeting this term</p>
                    </div>
                    <div class="div-2" style="float:right;">
                        <div class="data data-zero"><span class="value increase">{{ grant_percent|floatformat }}%</span></div>
                        <p>of UPE capitation grants received</p>
                    </div>
                    <div class="clear"></div>

                <div class="actions" style="float:left; margin-left: 190px;">
                    <a class="button button-purple" href="{% url emis-dash-admin-meetings %}"><span class="details">View Details</span></a>
                </div>
                <div class="actions">
                    <a class="button button-purple" href="{% url emis-grants %}"><span class="details">View Details</span></a>
                </div>
                </div>
            </div>
        </div>
    </div>
    <div class="sidebar">
        <div class="quick-stats">
<!--             <p><label>{{ schools_to_date }}</label><b>schools to date</b></p> -->
			
			<p><label>{{ total_reporters }}</label><b>Valid Reporters</b></p>
			<p><label>{{ total_schools }}</label><b>Schools Tracked</b></p>
            <p><label class="active" style="font-size:15px;"><a href="{% url emis-national-stats %}">{{ school_active|floatformat }}%</a>
            </label><b>Recently Reported</b></p>
        </div>
        <div class="attention section">
            <h2>Alerts</h2>
            <div class="items" id="top_5_error_messages">
            </div>
            <div class="items">
                <div class="">
                <a href="{% url emis-messagelog %}?error_msgs=True" class="button button-blue"><span class="messages">View All Alerts</span></a>
                <div class="clear"></div>
            </div>

                <div class="items">
                    <div class="" style="margin-top: 10px;">
                    <a href="{% url control-panel %}" class="button button-blue" style="width:inherit;"><span class="control">Control Panel</span></a>
                    <div class="clear"></div>
                    </div>
                </div>
                <div class="items">
                    <div class="" style="margin-top: 10px;">
                    <a href="{% url new-comment %}" class="button button-blue"><span class="control">Comment on Data</span></a>
                    <div class="clear"></div>
                </div>
            </div>
            </div>
        </div>
    </div>
</div>
    <script type="text/javascript" src="{{ MEDIA_URL }}education/javascripts/alert_messages.js"></script>
{% endblock %}
